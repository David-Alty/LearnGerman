<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Almanca</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 5 3%22><rect width=%225%22 height=%223%22 y=%220%22 fill=%22%23000000%22/><rect width=%225%22 height=%222%22 y=%221%22 fill=%22%23DD0000%22/><rect width=%225%22 height=%221%22 y=%222%22 fill=%22%23FFCE00%22/></svg>">
    <style>
        :root {
            --primary: #2980b9;
            --accent: #3498db;
            --success: #27ae60;
            --error: #c0392b;
            --bg: #ecf0f1;
            --text: #2c3e50;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            user-select: none; /* Metin seÃ§imini engelle, sÃ¼rÃ¼klemeyi kolaylaÅŸtÄ±r */
        }

        .container {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            width: 95%;
            max-width: 800px;
            text-align: center;
        }

        .header-info {
            display: flex;
            justify-content: space-between;
            color: #7f8c8d;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .question-box {
            background-color: #fff;
            padding: 15px;
            border-bottom: 2px solid #bdc3c7;
            margin-bottom: 20px;
        }

        .number-display {
            font-size: 4em;
            font-weight: 800;
            color: var(--error);
            margin: 0;
            line-height: 1;
        }

        .hint-text {
            color: #7f8c8d;
            font-style: italic;
            margin-top: 5px;
        }

        /* --- Ä°NÅžAAT ALANI (Target Zone) --- */
        .construction-zone {
            min-height: 80px;
            border: 3px dashed var(--accent);
            border-radius: 10px;
            background-color: #f7f9fa;
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* Ortala */
            align-items: center;
            gap: 10px;
            padding: 15px;
            margin-bottom: 10px;
            transition: background-color 0.3s, border-color 0.3s;
        }

        .construction-zone.drag-over {
            background-color: #ebf5fb;
            border-color: #2980b9;
            border-style: solid;
        }

        .construction-zone.correct {
            border-color: var(--success);
            background-color: #eafaf1;
            border-style: solid;
        }

        .construction-zone.wrong {
            border-color: var(--error);
            background-color: #fadbd8;
            animation: shake 0.4s;
        }

        /* --- KELÄ°ME KARTLARI (Draggables) --- */
        .word-chip {
            background-color: white;
            border: 2px solid #34495e;
            color: #34495e;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: grab;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s, box-shadow 0.1s;
            touch-action: none; /* Mobilde sÃ¼rÃ¼kleme iyileÅŸtirmesi */
        }

        .word-chip:active {
            cursor: grabbing;
        }

        /* SÃ¼rÃ¼klenirkenki gÃ¶rÃ¼nÃ¼m */
        .word-chip.dragging {
            opacity: 0.5;
            transform: scale(0.9);
            box-shadow: none;
        }

        /* Ä°nÅŸaat alanÄ±ndaki Ã§ipler */
        .construction-zone .word-chip {
            background-color: var(--accent);
            color: white;
            border-color: #2980b9;
        }

        /* --- HAVUZ (Source Pool) --- */
        .word-pool {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            padding: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            min-height: 60px;
        }

        /* Havuzda seÃ§ilmiÅŸ olanlar silikleÅŸsin */
        .word-pool .word-chip.used {
            opacity: 0.2;
            pointer-events: none;
            background-color: #95a5a6;
            border-color: #7f8c8d;
            box-shadow: none;
        }

        .controls {
            margin-top: 25px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.95); }

        .btn-check { background-color: var(--success); color: white; }
        .btn-reset { background-color: #95a5a6; color: white; }

        .text-preview {
            font-family: monospace;
            font-size: 1.2em;
            color: #555;
            height: 30px;
            margin-top: 10px;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body>

<div class="container" id="quiz-screen">
    <div class="header-info">
        <span>Almanca SayÄ± MimarÄ±</span>
        <span id="q-counter">Soru 1 / 10</span>
    </div>

    <div class="question-box">
        <div class="number-display" id="target-num">...</div>
        <div class="hint-text" id="target-hint"></div>
    </div>

    <p>ParÃ§alarÄ± aÅŸaÄŸÄ±daki kutuya sÃ¼rÃ¼kleyin (Araya ekleme yapabilirsiniz):</p>

    <div class="construction-zone" id="drop-zone">
        <span style="color:#bdc3c7; pointer-events:none;" id="placeholder-msg">ParÃ§alarÄ± buraya bÄ±rakÄ±n...</span>
    </div>

    <div class="text-preview" id="preview-text"></div>

    <div class="word-pool" id="source-pool">
        </div>

    <h3 id="feedback-msg" style="height: 25px;"></h3>

    <div class="controls">
        <button class="btn btn-reset" onclick="resetLevel()">SÄ±fÄ±rla</button>
        <button class="btn btn-check" id="action-btn" onclick="checkAnswer()">Kontrol Et</button>
    </div>
</div>

<div class="container" id="end-screen" style="display: none;">
    <h1 style="color: var(--success)">Tebrikler! ðŸŽ“</h1>
    <p>Almanca sayÄ± kurallarÄ±nÄ± ustaca birleÅŸtirdin.</p>
    <button class="btn btn-check" onclick="startQuiz()">Yeniden BaÅŸla</button>
</div>

<script>
    /* VERÄ° SETÄ° (PDF KaynaklÄ±) */
    const questions = [
        { val: "13", hint: "Ã–nce birler, sonra onlar (Ters yok)", parts: ["drei", "zehn"], distractors: ["und", "dreiÃŸig"] },
        { val: "17", hint: "Dikkat: 'en' dÃ¼ÅŸer! [cite: 65]", parts: ["sieb", "zehn"], distractors: ["sieben", "und"] },
        { val: "21", hint: "Dikkat: 's' dÃ¼ÅŸer! [cite: 73]", parts: ["ein", "und", "zwanzig"], distractors: ["eins", "zwei"] },
        { val: "35", hint: "Ters MantÄ±k: 5 ve 30", parts: ["fÃ¼nf", "und", "dreiÃŸig"], distractors: ["drei", "fÃ¼nfzig", "zehn"] },
        { val: "1981", hint: "YÄ±l OkunuÅŸu (19.. 81) [cite: 124]", parts: ["neunzehn", "hundert", "ein", "und", "achtzig"], distractors: ["tausend", "eins"] },
        { val: "2023", hint: "YÄ±l (2000+) Normal okunur [cite: 134]", parts: ["zwei", "tausend", "drei", "und", "zwanzig"], distractors: ["hundert", "null"] },
        { val: "99", hint: "9 ve 90", parts: ["neun", "und", "neunzig"], distractors: ["neunzehn"] },
        { val: "70", hint: "Dikkat: 'en' dÃ¼ÅŸer [cite: 83]", parts: ["siebzig"], distractors: ["siebenzig", "sieben"] },
        { val: "16", hint: "Dikkat: 's' dÃ¼ÅŸer [cite: 61]", parts: ["sech", "zehn"], distractors: ["sechs", "und"] },
        { val: "105", hint: "YÃ¼z beÅŸ (und yok)", parts: ["ein", "hundert", "fÃ¼nf"], distractors: ["und", "fÃ¼nfzig"] }
    ];

    let currentQ = 0;
    let currentData = null;
    let draggedItem = null;
    let dragSource = null; // 'pool' or 'zone'

    function startQuiz() {
        document.getElementById('end-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        currentQ = 0;
        loadQuestion();
    }

    function loadQuestion() {
        if(currentQ >= questions.length) {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('end-screen').style.display = 'block';
            return;
        }

        // Rastgele soru seÃ§miyoruz, sÄ±rayla gidiyoruz (veya karÄ±ÅŸtÄ±rÄ±labilir)
        // Burada basitlik iÃ§in sÄ±rayla.
        currentData = questions[currentQ];

        document.getElementById('q-counter').innerText = `Soru ${currentQ + 1} / ${questions.length}`;
        document.getElementById('target-num').innerText = currentData.val;
        document.getElementById('target-hint').innerText = currentData.hint;
        document.getElementById('feedback-msg').innerText = "";
        document.getElementById('drop-zone').className = "construction-zone";
        document.getElementById('preview-text').innerText = "";
        document.getElementById('action-btn').innerText = "Kontrol Et";
        document.getElementById('action-btn').onclick = checkAnswer;
        document.getElementById('action-btn').style.backgroundColor = "var(--success)";

        // Drop Zone Temizle
        const zone = document.getElementById('drop-zone');
        zone.innerHTML = '<span style="color:#bdc3c7; pointer-events:none;" id="placeholder-msg">ParÃ§alarÄ± buraya bÄ±rakÄ±n...</span>';

        // Havuz OluÅŸtur
        const pool = document.getElementById('source-pool');
        pool.innerHTML = '';
        
        let allWords = [...currentData.parts, ...currentData.distractors];
        allWords.sort(() => Math.random() - 0.5);

        allWords.forEach((word, idx) => {
            const el = createChip(word, 'pool-' + idx);
            pool.appendChild(el);
        });

        setupDragAndDrop();
    }

    function createChip(text, id) {
        const div = document.createElement('div');
        div.classList.add('word-chip');
        div.setAttribute('draggable', 'true');
        div.innerText = text;
        div.id = id;
        div.dataset.val = text;
        
        // Desktop Drag Events
        div.addEventListener('dragstart', handleDragStart);
        div.addEventListener('dragend', handleDragEnd);
        
        // Basit tÄ±klama ile taÅŸÄ±ma (Mobil/HÄ±zlÄ± kullanÄ±m iÃ§in opsiyonel)
        div.addEventListener('click', () => handleClickTransfer(div));

        return div;
    }

    /* --- DRAG & DROP MANTIÄžI (Insert Anywhere) --- */
    
    const zone = document.getElementById('drop-zone');

    function setupDragAndDrop() {
        zone.addEventListener('dragover', handleDragOver);
        zone.addEventListener('dragenter', e => e.preventDefault());
        zone.addEventListener('drop', handleDrop);
    }

    function handleDragStart(e) {
        draggedItem = this;
        dragSource = this.parentElement.id === 'drop-zone' ? 'zone' : 'pool';
        
        // GÃ¶rsel efekt iÃ§in gecikme
        setTimeout(() => this.classList.add('dragging'), 0);
        e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragEnd(e) {
        this.classList.remove('dragging');
        draggedItem = null;
        updatePreview();
    }

    function handleDragOver(e) {
        e.preventDefault(); // Drop'a izin ver
        
        // Hangi elemandan sonra ekleyeceÄŸiz?
        const afterElement = getDragAfterElement(zone, e.clientX);
        const placeholder = document.getElementById('placeholder-msg');
        if(placeholder) placeholder.style.display = 'none';

        const dragging = document.querySelector('.dragging');
        if (afterElement == null) {
            zone.appendChild(dragging);
        } else {
            zone.insertBefore(dragging, afterElement);
        }
    }

    // Fare pozisyonuna gÃ¶re en yakÄ±n elemanÄ± bulma (INSERT MANTIÄžI BURADA)
    function getDragAfterElement(container, x) {
        // Sadece sÃ¼rÃ¼klenmeyen elemanlarÄ± al
        const draggableElements = [...container.querySelectorAll('.word-chip:not(.dragging)')];

        return draggableElements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            // Yatay eksende (x) merkeze gÃ¶re konum
            const offset = x - box.left - box.width / 2;
            
            // Mouse elemanÄ±n solundaysa (offset negatif) ve en bÃ¼yÃ¼k negatifse (en yakÄ±n)
            if (offset < 0 && offset > closest.offset) {
                return { offset: offset, element: child };
            } else {
                return closest;
            }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
    }

    function handleDrop(e) {
        e.preventDefault();
        
        // EÄŸer havuzdan geldiyse, havuzdaki orijinalini "used" yap
        if(dragSource === 'pool') {
            const originalId = draggedItem.id;
            // Biz ÅŸu an kopyasÄ±nÄ± (veya kendisini) taÅŸÄ±dÄ±k. 
            // Ancak UI mantÄ±ÄŸÄ± gereÄŸi, havuzda "silik" bir kopyasÄ± kalsÄ±n istiyorsak:
            // Bu Ã¶rnekte direkt taÅŸÄ±ma yapÄ±yoruz, havuzda kalmÄ±yor.
            // EÄŸer havuzda kalsÄ±n istiyorsan klonlama mantÄ±ÄŸÄ± gerekir. 
            // Basitlik iÃ§in direkt taÅŸÄ±ma yapÄ±yoruz.
        }
        updatePreview();
    }

    /* --- TIKLAYARAK TAÅžIMA (Alternatif) --- */
    function handleClickTransfer(el) {
        const parent = el.parentElement;
        const placeholder = document.getElementById('placeholder-msg');

        if (parent.id === 'source-pool') {
            // Havuzdan Zone'a (Sona ekle)
            if(placeholder) placeholder.style.display = 'none';
            zone.appendChild(el);
        } else {
            // Zone'dan Havuza (Geri gÃ¶nder)
            const pool = document.getElementById('source-pool');
            pool.appendChild(el);
            if(zone.children.length === 1) { // Sadece placeholder kaldÄ±ysa
                 if(placeholder) placeholder.style.display = 'block';
            }
        }
        updatePreview();
    }

    function updatePreview() {
        // Zone iÃ§indeki kelimeleri sÄ±rayla oku
        const chips = zone.querySelectorAll('.word-chip');
        let text = "";
        chips.forEach(chip => text += chip.dataset.val);
        document.getElementById('preview-text').innerText = text;
        
        if(chips.length === 0) {
            const ph = document.getElementById('placeholder-msg');
            if(ph) ph.style.display = 'block';
        }
    }

    function resetLevel() {
        loadQuestion();
    }

    function checkAnswer() {
        const chips = zone.querySelectorAll('.word-chip');
        let userAns = "";
        chips.forEach(chip => userAns += chip.dataset.val);
        
        const correctAns = currentData.parts.join('');
        const fb = document.getElementById('feedback-msg');
        const btn = document.getElementById('action-btn');

        if (userAns === correctAns) {
            // DOÄžRU
            document.getElementById('drop-zone').className = "construction-zone correct";
            fb.innerText = "Harika! DoÄŸru sÄ±ralama. ðŸŽ‰";
            fb.style.color = "var(--success)";
            
            btn.innerText = "Sonraki Soru >>";
            btn.onclick = () => { currentQ++; loadQuestion(); };
        } else {
            // YANLIÅž
            document.getElementById('drop-zone').className = "construction-zone wrong";
            setTimeout(() => document.getElementById('drop-zone').className = "construction-zone", 500);
            
            fb.innerText = "HenÃ¼z olmadÄ±. SÄ±ralamayÄ± kontrol et.";
            fb.style.color = "var(--error)";
        }
    }

    // BaÅŸlangÄ±Ã§
    startQuiz();

</script>
</body>
</html>